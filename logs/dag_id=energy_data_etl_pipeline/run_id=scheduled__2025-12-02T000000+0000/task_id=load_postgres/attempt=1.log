{"timestamp":"2025-12-02T18:26:04.294401Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-12-02T18:26:04.295492Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/energy_etl_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-12-02T18:26:04.330044Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/energy_etl_dag.py","lineno":8,"logger":"py.warnings"}
{"timestamp":"2025-12-02T18:26:04.352374Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.353018Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.353356Z","level":"info","event":"Current task name:load_postgres","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.353606Z","level":"info","event":"Dag name:energy_data_etl_pipeline","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.375880Z","level":"info","event":"✓ Using Airflow connection: postgres_energy_data","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.386699Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.387408Z","level":"info","event":"Loading: co2_emissions -> cleaned_co2_emissions","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.417097Z","level":"info","event":"  Rows: 29,384","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:04.417607Z","level":"info","event":"  Columns: 8","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.240832Z","level":"info","event":"  ✗ Error loading co2_emissions: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.241406Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(cleaned_co2_emissions, 2200) already exists.","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.241757Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.242028Z","level":"info","event":"[SQL:","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.242244Z","level":"info","event":"CREATE TABLE cleaned_co2_emissions (","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.242453Z","level":"info","event":"\tentity TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.242661Z","level":"info","event":"\tcode TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.242873Z","level":"info","event":"\tyear BIGINT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.243191Z","level":"info","event":"\tannual_co2_emissions FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.243510Z","level":"info","event":"\tdata_source TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.243728Z","level":"info","event":"\tdata_quality_flag TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.243950Z","level":"info","event":"\tlast_updated DATE,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.244229Z","level":"info","event":"\tentity_type TEXT","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.244613Z","level":"info","event":")","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.244914Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.245190Z","level":"info","event":"]","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.245455Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.241045Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":994,"error_detail":[{"exc_type":"IntegrityError","exc_value":"(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(cleaned_co2_emissions, 2200) already exists.\n\n[SQL: \nCREATE TABLE cleaned_co2_emissions (\n\tentity TEXT, \n\tcode TEXT, \n\tyear BIGINT, \n\tannual_co2_emissions FLOAT(53), \n\tdata_source TEXT, \n\tdata_quality_flag TEXT, \n\tlast_updated DATE, \n\tentity_type TEXT\n)\n\n]\n(Background on this error at: https://sqlalche.me/e/14/gkpj)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1307,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/energy_etl_dag.py","lineno":212,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3008,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":788,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1948,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1852,"name":"prep_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":936,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":922,"name":"_execute_create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py","lineno":962,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2221,"name":"_run_ddl_visitor"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py","lineno":524,"name":"traverse_single"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":899,"name":"visit_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":80,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1477,"name":"_execute_ddl"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(cleaned_co2_emissions, 2200) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-12-02T18:26:10.276568Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.277770Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.278779Z","level":"info","event":"Task:<Task(PythonOperator): load_postgres>","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.279312Z","level":"info","event":"Failure caused by (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.279817Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(cleaned_co2_emissions, 2200) already exists.","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.280323Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.280977Z","level":"info","event":"[SQL:","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.281550Z","level":"info","event":"CREATE TABLE cleaned_co2_emissions (","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.282074Z","level":"info","event":"\tentity TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.282686Z","level":"info","event":"\tcode TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.283056Z","level":"info","event":"\tyear BIGINT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.283403Z","level":"info","event":"\tannual_co2_emissions FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.283687Z","level":"info","event":"\tdata_source TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.284010Z","level":"info","event":"\tdata_quality_flag TEXT,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.284276Z","level":"info","event":"\tlast_updated DATE,","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.284596Z","level":"info","event":"\tentity_type TEXT","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.284923Z","level":"info","event":")","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.285289Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.285676Z","level":"info","event":"]","logger":"task.stdout"}
{"timestamp":"2025-12-02T18:26:10.286026Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","logger":"task.stdout"}
